(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{165:function(e,t,n){"use strict";function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.r(t);var r=n(19),c=n.n(r),i=n(28),o=n(8),s=n(9),l=n(11),u=n(10),h=n(12),p=n(0),d=n.n(p),f=n(13),m=n(81),v=n(92),b=n(91);n.d(t,"default",function(){return y});var g=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,s=new Array(r),h=0;h<r;h++)s[h]=arguments[h];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={checked:n.props.checked,categories:[]},n.getCategories=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isrender:!0}),e.next=3,Object(m.a)("/api/category");case 3:t=e.sent,n.setState({categories:t.data});case 5:case"end":return e.stop()}},e)})),n.onChange=function(e){var t=a(n.state.checked),r=e.target;r.checked?t.push(r.id):t.splice(t.findIndex(function(e){return e===r.id}),1),n.props.onChange&&n.props.onChange(t),n.setState({checked:t})},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.checked!==e.checked&&this.setState({checked:e.checked})}},{key:"componentDidMount",value:function(){this.getCategories()}},{key:"render",value:function(){var e=this,t=this.state,n=t.checked,a=t.categories;return this.value=n,d.a.createElement(p.Fragment,null,a.length>0?a.map(function(t){return d.a.createElement(p.Fragment,{key:t._id},d.a.createElement("input",{className:"checkbox",type:"checkbox",onChange:e.onChange,checked:n.indexOf(t._id)>=0,id:t._id}),d.a.createElement("label",{className:"article-tag",htmlFor:t._id},t.name))}):d.a.createElement("label",{className:"article-tag article-tag-loading"},"\u6b63\u5728\u52a0\u8f7d..."))}}]),t}(p.PureComponent),k=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={value:n.props.defaultValue},n.onChange=function(e){var t=e.target.value;n.timer&&clearTimeout(n.timer),n.timer=setTimeout(function(){n.setState({value:t}),n.props.onChange&&n.props.onChange(t)},300)},n.onkeydown=function(e){if(9===e.keyCode){e.preventDefault();var t=e.target,n=t.value,a=t.selectionStart,r=t.selectionEnd;t.value=n.substr(0,a)+"  "+n.substr(r),t.selectionStart=a+2,t.selectionEnd=a+2}},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.props.defaultValue!==e.defaultValue&&(this.setState({value:e.defaultValue}),this.textarea.value=e.defaultValue)}},{key:"render",value:function(){var e=this,t=this.state.value;this.value=t;var n=this.props,a=n.className,r=n.rows,c=n.placeholder;return d.a.createElement("div",{className:"mark-body "+a},d.a.createElement("textarea",{ref:function(t){return e.textarea=t},placeholder:c,spellCheck:!1,onKeyDown:this.onkeydown,onChange:this.onChange,rows:r,className:"mark-textarea edit-input"}),d.a.createElement("div",{className:"mark-preview"},d.a.createElement(v.a,{value:t})))}}]),t}(p.PureComponent),y=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isrender:!0,article:{}},n.getArticle=function(){var e=Object(i.a)(c.a.mark(function e(t){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isrender:!0}),e.next=3,Object(m.a)("/api/article/".concat(t,"?admin=true"));case 3:a=e.sent,n.setState({article:a.data,isrender:!1}),n.title.value=a.data.title||"";case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onSubmit=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={title:n.title.value,categories:n.categories.value,description:n.description.value,content:n.content.value},!n.id){e.next=8;break}return e.next=4,Object(m.a)("/api/article/".concat(n.id),{method:"PUT",body:JSON.stringify(t)});case 4:e.sent.success&&(console.log("success1"),f.Control.go(-1)),e.next=13;break;case 8:return t.userId="5b34af1cf532152535c6c03a",e.next=11,Object(m.a)("/api/article",{method:"POST",body:JSON.stringify(t)});case 11:e.sent.success&&(console.log("success2"),f.Control.go(-1));case 13:case"end":return e.stop()}},e)})),n.goTop=function(){document.getElementById("publish-con").scrollTo({top:0,behavior:"smooth"})},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.id=f.Control.path.split("publish/")[1],this.id&&this.getArticle(this.id)}},{key:"componentWillReceiveProps",value:function(e){f.Control.path.indexOf("publish/")>=0&&this.props.pathname!==e.pathname&&this.id!==f.Control.path.split("publish/")[1]?(this.id=f.Control.path.split("publish/")[1],this.getArticle(this.id)):(this.id=null,this.title.value="",this.setState({article:{}}))}},{key:"render",value:function(){var e=this,t=this.state.article,n=t.categories,a=void 0===n?[]:n,r=t.description,c=void 0===r?"":r,i=t.content,o=void 0===i?"":i;return d.a.createElement("div",{className:"container admin-container",id:"publish-con"},d.a.createElement("section",{className:"main sildeUpMin"},d.a.createElement("div",{className:"admin-title"},"\u6807\u9898"),d.a.createElement("input",{ref:function(t){return e.title=t},spellCheck:!1,className:"edit-input"}),d.a.createElement("div",{className:"admin-title"},"\u5206\u7c7b"),d.a.createElement(g,{ref:function(t){return e.categories=t},checked:a}),d.a.createElement("div",{className:"admin-title"},"\u7b80\u4ecb"),d.a.createElement(k,{ref:function(t){return e.description=t},rows:3,placeholder:"\u4e00\u4e9b\u7b80\u4ecb~",defaultValue:c}),d.a.createElement("div",{className:"admin-title"},"\u6b63\u6587"),d.a.createElement(k,{ref:function(t){return e.content=t},className:"admin-content",rows:10,placeholder:"\u5f00\u59cb\u5199\u6587\u7ae0\u5427!",defaultValue:o}),d.a.createElement("span",{className:"admin-add-button",onClick:this.onSubmit},"\u7acb\u5373\u53d1\u5e03")),d.a.createElement(b.a,{onClick:this.goTop}))}}]),t}(p.PureComponent)},81:function(e,t,n){"use strict";var a=n(19),r=n.n(a),c=n(28),i=function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,i,o,s,l=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},a=n.method,c=void 0===a?"GET":a,i=n.headers,o=void 0===i?{"Content-Type":"application/json"}:i,s=n.body,e.prev=1,e.next=4,fetch(t,Object.assign({method:c,headers:o},s?{body:s}:{})).then(function(e){if(e.ok)return e.json()}).catch(function(e){console.warn(e)});case 4:return e.abrupt("return",e.sent);case 7:e.prev=7,e.t0=e.catch(1),console.err(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t){return e.apply(this,arguments)}}();t.a=i},91:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(8),r=n(9),c=n(11),i=n(10),o=n(12),s=n(0),l=n.n(s),u=function(e){function t(){return Object(a.a)(this,t),Object(c.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("a",{className:"backTop leftIn",onClick:this.props.onClick},l.a.createElement("span",null,l.a.createElement("i",{className:"iconfont icon-backtotop"})))}}]),t}(s.PureComponent)},92:function(e,t,n){"use strict";var a=n(0),r=n.n(a),c=n(95),i=n.n(c),o=n(101),s=n.n(o);n(94);t.a=function(e){return r.a.createElement("div",{className:"preview",dangerouslySetInnerHTML:function(e){var t=new i.a({html:!0,breaks:!0,typographer:!0,langPrefix:"",highlight:function(e,t){if(t&&s.a.getLanguage(t))try{return s.a.configure({classPrefix:""}),s.a.highlight(t,e).value}catch(n){}try{return s.a.configure({classPrefix:""}),s.a.highlightAuto(e).value}catch(n){}return""}});return t.core.ruler.enable(["abbr"]),t.inline.ruler.enable(["footnote_inline","ins","mark","sub","sup"]),{__html:t.render(e)}}(e.value)})}},94:function(e,t,n){}}]);
//# sourceMappingURL=7.2e49636c.chunk.js.map